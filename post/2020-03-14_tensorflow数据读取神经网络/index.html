<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>TensorFlow数据读取、神经网络 - Even - A super concise theme for Hugo</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="zyuanlee"><meta name=description content="文件读取流程 QueueRunner 基于队列的输入管道从 TensorFLow 图形开头文件中读取数据 Feeding 运行每一步时，Python 代码提供数据 预加载数据 TensorFlow 图中的张量包含的数据（对于小数"><meta name=keywords content="Hugo,theme,even"><meta name=generator content="Hugo 0.85.0 with theme even"><link rel=canonical href=http://localhost:1313/post/2020-03-14_tensorflow%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link href=/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:title" content="TensorFlow数据读取、神经网络"><meta property="og:description" content="文件读取流程 QueueRunner 基于队列的输入管道从 TensorFLow 图形开头文件中读取数据 Feeding 运行每一步时，Python 代码提供数据 预加载数据 TensorFlow 图中的张量包含的数据（对于小数"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/post/2020-03-14_tensorflow%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"><meta property="article:section" content="post"><meta property="article:published_time" content="2020-03-14T18:03:00+00:00"><meta property="article:modified_time" content="2020-03-14T18:03:00+00:00"><meta itemprop=name content="TensorFlow数据读取、神经网络"><meta itemprop=description content="文件读取流程 QueueRunner 基于队列的输入管道从 TensorFLow 图形开头文件中读取数据 Feeding 运行每一步时，Python 代码提供数据 预加载数据 TensorFlow 图中的张量包含的数据（对于小数"><meta itemprop=datePublished content="2020-03-14T18:03:00+00:00"><meta itemprop=dateModified content="2020-03-14T18:03:00+00:00"><meta itemprop=wordCount content="4801"><meta itemprop=keywords content="TensorFlow,深度学习,"><meta name=twitter:card content="summary"><meta name=twitter:title content="TensorFlow数据读取、神经网络"><meta name=twitter:description content="文件读取流程 QueueRunner 基于队列的输入管道从 TensorFLow 图形开头文件中读取数据 Feeding 运行每一步时，Python 代码提供数据 预加载数据 TensorFlow 图中的张量包含的数据（对于小数"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>Even</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>Home</li></a><a href=/post/><li class=mobile-menu-item>Archives</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a><a href=/categories/><li class=mobile-menu-item>Categories</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>Even</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Home</a></li><li class=menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=/categories/>Categories</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>TensorFlow数据读取、神经网络</h1><div class=post-meta><span class=post-time>2020-03-14</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><ul><li><a href=#文件读取流程>文件读取流程</a><ul><li><a href=#文件读取流程-1>文件读取流程</a></li><li><a href=#线程操作>线程操作</a></li></ul></li><li><a href=#图片数据>图片数据</a><ul><li><a href=#图片基本知识>图片基本知识</a></li><li><a href=#图片特征值处理>图片特征值处理</a></li><li><a href=#数据格式>数据格式</a></li><li><a href=#案例狗图片读取>案例：狗图片读取</a></li></ul></li><li><a href=#二进制文件>二进制文件</a><ul><li><a href=#cifar10-二进制数据集介绍>CIFAR10 二进制数据集介绍</a></li><li><a href=#流程>流程</a></li></ul></li><li><a href=#tfrecords-文件>TFRecords 文件</a><ul><li><a href=#结构分析>结构分析</a></li><li><a href=#案例cifar10-数据存入-tfrecords>案例：CIFAR10 数据存入 TFRecords</a></li><li><a href=#案例读取-tfrecords>案例：读取 TFRecords</a></li></ul></li><li><a href=#神经网络基础>神经网络基础</a><ul><li><a href=#神经网络>神经网络</a></li><li><a href=#神经网络基础-1>神经网络基础</a></li><li><a href=#案例mnist-手写数字识别>案例：Mnist 手写数字识别</a></li></ul></li></ul></li></ul></nav></div></div><div class=post-content><h2 id=文件读取流程>文件读取流程</h2><ul><li>QueueRunner<ul><li>基于队列的输入管道从 TensorFLow 图形开头文件中读取数据</li></ul></li><li>Feeding<ul><li>运行每一步时，Python 代码提供数据</li></ul></li><li>预加载数据<ul><li>TensorFlow 图中的张量包含的数据（对于小数据集）</li></ul></li></ul><h3 id=文件读取流程-1>文件读取流程</h3><ul><li>第一阶段：构造文件名队列</li><li>第二阶段：读取与解码</li><li>第三阶段：批处理</li></ul><h4 id=构造文件名队列>构造文件名队列</h4><ul><li><code>tf.train.string_input_producer(string_tensor, shuffle=True)</code><ul><li>string_tensor：含有文件名+路径的一阶张量</li><li>num_epochs：过几遍数据，默认无限遍数据</li><li>return：文件队列<code>file_queue</code></li></ul></li></ul><h4 id=读取和解码>读取和解码</h4><p>从队列当中读取文件内容，并进行解码操作</p><h5 id=读取文件内容>读取文件内容</h5><p>默认每次读取一个样本</p><blockquote><p>文本文件默认一次读取一行，图片默认一次读取一张图片，二进制文件一次读取指定字节数（最好一个样本的字节数），TFRecords 默认一次读取一个 example</p></blockquote><ul><li><code>tf.TextLineReader</code><ul><li>阅读文本文件都好分隔符值（CSV）格式，默认按行读取</li><li>return：读取器实例</li></ul></li><li><code>tf.WholeFileReader()</code><ul><li>用于读取图片文件</li><li>return：读取器实例</li></ul></li><li><code>tf.FixedLengthRecordReader(record_bytes)</code><ul><li>二进制文件</li><li>要读取每个记录是固定数量字节的二进制文件</li><li>record_bytes：整数，指定每次读取（一个样本）的字节数</li><li>return：读取器实例</li></ul></li><li><code>tf.TFRecordReader</code><ul><li>读取 TFRecords 文件</li><li>return：读取器实例</li></ul></li></ul><blockquote><p>它们有共同的读取方法：<code>read(file_queue)</code>，并且都会返回一个 Tensor 元组</p><p><code>(key文件名字, value默认的内容（一个文本）)</code></p><p>由于默认只会读取一个样本，所以如果想要进行批处理，需要使用<code>tf.train.batch</code>或<code>tf.train.shuffle_batch</code>进行批处理操作，便于之后指定每批次多个样本的训练</p></blockquote><h5 id=内容解码>内容解码</h5><ul><li>文本<ul><li><code>tf.decode_csv()</code></li></ul></li><li>图片<ul><li><code>tf.image.decode_jpeg(contents)</code><ul><li>将 JPEG 编码的图像解码为 uint8 张量</li><li>return：uint8 张量，3-D 形状[height, width, channels]</li></ul></li><li><code>tf.image.decode_png(contents)</code></li></ul></li><li>二进制<ul><li><code>tf.decode_raw(value, tf.uint8)</code><ul><li>与<code>tf.FixedLengthRecordReader</code>搭配使用，二进制读取为 uint8</li></ul></li></ul></li></ul><blockquote><p>解码阶段，默认所有的内容都解码成<code>tf.uint8</code>类型，如果需要转换成指定类型，可以使用<code>tf.cast()</code>进行转换</p></blockquote><h4 id=批处理>批处理</h4><p>解码之后，可以直接获取默认的一个样本内容，但如果想要获取多个样本，需要加入到新的队列进行批处理</p><ul><li><code>tf.train.batch(tensors, batch_size, num_threads=1, capacity=32, name=None)</code><ul><li>读取指定大小（个数）的张量</li><li>tensors：可以是包含张量的列表，批处理的内容放到列表当中</li><li>batch_size：从队列中读取的批处理大小</li><li>num_threads：进入队列的线程数</li><li>capacity：整数，队列中元素的最大数量</li><li>return：tensors</li></ul></li><li><code>tf.train.shuffle_batch</code></li></ul><h3 id=线程操作>线程操作</h3><p>以上的队列都是<code>tf.train.QueueRunner</code>对象</p><p>每个 QueueRunner 都负责一个阶段，会话中，<code>tf.train.start_queue_runners</code>函数会要求图中的每个 QueueRunner 启动它的运行队列操作的线程，（这些操作需要在会话中开启）</p><ul><li><code>tf.train.start_queue_runners(sess=None, coord=None)</code><ul><li>收集图中所有的队列线程，默认同时启动线程</li><li>sess：所在的会话</li><li>coord：线程协调器</li><li>return：所有线程</li></ul></li><li><code>tf.train.Coordinator()</code><ul><li>线程调度员，对线程进行管理和协调</li><li><code>request_stop()</code>：请求停止</li><li><code>should_stop()</code>：询问是否结束</li><li><code>join(threads=None, stop_grace_period_secs=120)</code>：回收线程</li><li>return：线程协调员实例</li></ul></li></ul><h2 id=图片数据>图片数据</h2><h3 id=图片基本知识>图片基本知识</h3><ul><li>特征抽取<ul><li>文本——数值（二维数组<code>shape(n_samples, m_features)</code>）</li><li>字典——数值（二维数组<code>shape(n_samples, m_features)</code>）</li><li>图片——数值（二维数组<code>shape(n_samples, m_features)</code>）</li></ul></li></ul><h4 id=图片三要素>图片三要素</h4><ul><li>图片长度、图片宽度、图片通道数</li><li>灰度图<ul><li>[长, 宽, 1]</li><li>每一个像素点一个[0, 255]数</li></ul></li><li>彩色图<ul><li>[长, 宽, 3]</li><li>每一个像素点三个[0, 255]数组成</li></ul></li></ul><h4 id=张量形状>张量形状</h4><p><code>Tensor(指令名称, shape, dtype)</code></p><ul><li>一张图片<ul><li><code>shape = (height, width, channels)</code></li></ul></li><li>多张图片<ul><li><code>shape = (batch, height, width, channels)</code></li><li>batch：表示一个批次的张量数量</li></ul></li></ul><h3 id=图片特征值处理>图片特征值处理</h3><ul><li>样本数据量大</li><li>样本大小形状不统一</li><li>解决：把图片缩小到统一大小</li><li><code>tf.image.resize_images(imags, size)</code><ul><li>缩小放大图片</li><li>images：4-D 形状<code>[batch, height, width, channels]</code>或 3-D 形状的张量<code>[height, width, channels]</code>的图片数据</li><li>size：1-D int32 张量：new_height, new_width, 图像的新尺寸</li><li>返回 4-D 格式或者 3-D 格式图片</li></ul></li></ul><h3 id=数据格式>数据格式</h3><ul><li>存储：uint8（节约空间）</li><li>矩阵计算：float32（提高精度）</li></ul><h3 id=案例狗图片读取>案例：狗图片读取</h3><h4 id=构造文件名队列-1>构造文件名队列</h4><h4 id=读取与解码>读取与解码</h4><p>使样本的形状和类型统一</p><h4 id=批处理-1>批处理</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>os</span>
<span class=kn>import</span> <span class=nn>tensorflow</span> <span class=k>as</span> <span class=nn>tf</span>


<span class=k>def</span> <span class=nf>pic_read</span><span class=p>(</span><span class=n>file_list</span><span class=p>):</span>
    <span class=s2>&#34;&#34;&#34;
</span><span class=s2>    狗图片读取
</span><span class=s2>    :param file_list:
</span><span class=s2>    :return:
</span><span class=s2>    &#34;&#34;&#34;</span>
    <span class=c1># 1、构造文件名队列</span>
    <span class=n>file_queue</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>string_input_producer</span><span class=p>(</span><span class=n>file_list</span><span class=p>)</span>
    <span class=c1># 2、读取与解码</span>
    <span class=n>reader</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>WholeFileReader</span><span class=p>()</span>
    <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=o>=</span> <span class=n>reader</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>file_queue</span><span class=p>)</span>
    <span class=c1># print(key, value)</span>
    <span class=n>image</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>image</span><span class=o>.</span><span class=n>decode_jpeg</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
    <span class=c1># print(image)</span>

    <span class=c1># 3、批处理</span>
    <span class=c1># 图片统一</span>
    <span class=n>resize_image</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>image</span><span class=o>.</span><span class=n>resize_images</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=p>[</span><span class=mi>200</span><span class=p>,</span> <span class=mi>200</span><span class=p>])</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>resize_image</span><span class=p>)</span>
    <span class=c1># Tensor(&#34;resize/Squeeze:0&#34;, shape=(200, 200, ?), dtype=float32)</span>

    <span class=c1># 通道数固定，shape形状确定</span>
    <span class=c1># 也可用动态修改</span>
    <span class=n>resize_image</span><span class=o>.</span><span class=n>set_shape</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=p>[</span><span class=mi>200</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>

    <span class=n>image_batch</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>batch</span><span class=p>([</span><span class=n>resize_image</span><span class=p>],</span> <span class=n>batch_size</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>num_threads</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>capacity</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>image_batch</span><span class=p>)</span>
    <span class=c1># Tensor(&#34;batch:0&#34;, shape=(100, 200, 200, 3), dtype=float32)</span>

    <span class=k>with</span> <span class=n>tf</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span> <span class=k>as</span> <span class=n>sess</span><span class=p>:</span>
        <span class=c1># 开启线程</span>
        <span class=c1># 创建线程协调员</span>
        <span class=n>coord</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>Coordinator</span><span class=p>()</span>
        <span class=n>threads</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>start_queue_runners</span><span class=p>(</span><span class=n>sess</span><span class=o>=</span><span class=n>sess</span><span class=p>,</span> <span class=n>coord</span><span class=o>=</span><span class=n>coord</span><span class=p>)</span>
        <span class=n>key_new</span><span class=p>,</span> <span class=n>value_new</span><span class=p>,</span> <span class=n>image_new</span> <span class=o>=</span> <span class=n>sess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=n>image</span><span class=p>])</span>
        <span class=nb>print</span><span class=p>(</span><span class=n>key_new</span><span class=p>)</span>
        <span class=nb>print</span><span class=p>(</span><span class=n>value_new</span><span class=p>)</span>
        <span class=nb>print</span><span class=p>(</span><span class=n>image_new</span><span class=p>)</span>

        <span class=c1># 回收线程</span>
        <span class=n>coord</span><span class=o>.</span><span class=n>request_stop</span><span class=p>()</span>
        <span class=n>coord</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>threads</span><span class=o>=</span><span class=n>threads</span><span class=p>)</span>


<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
    <span class=c1># 构造路径+文件名列表</span>
    <span class=n>filename</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;.\dog&#39;</span><span class=p>)</span>
    <span class=c1># print(filename)</span>
    <span class=n>file_list</span> <span class=o>=</span> <span class=p>[</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;.\dog&#39;</span><span class=p>,</span> <span class=n>file</span><span class=p>)</span> <span class=k>for</span> <span class=n>file</span> <span class=ow>in</span> <span class=n>filename</span><span class=p>]</span>
    <span class=c1># print(file_list)</span>
    <span class=n>pic_read</span><span class=p>(</span><span class=n>file_list</span><span class=p>)</span>

</code></pre></td></tr></table></div></div><h2 id=二进制文件>二进制文件</h2><h3 id=cifar10-二进制数据集介绍>CIFAR10 二进制数据集介绍</h3><p>每 3073 个字节是一个样本</p><ul><li>1 个目标值+3072 像素<ul><li>1024 字节，红色通道</li><li>1024 字节，绿色通道</li><li>1024，蓝色通道</li></ul></li></ul><h3 id=流程>流程</h3><h4 id=构造文件名队列-2>构造文件名队列</h4><h4 id=读取与解码-1>读取与解码</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=n>reader</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>FixedLengthRecordReader</span><span class=p>(</span><span class=mi>3073</span><span class=p>)</span>
<span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=o>=</span> <span class=n>reader</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>file_queue</span><span class=p>)</span>
<span class=n>decode</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>decode_raw</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>tf</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><p>对 tensor 对象切片</p><p>原图片矩阵
[[32 * 32 的二维数组],
[32 * 32 的二维数组],
[32 * 32 的二维数组]]
&ndash;> [3, 32, 32]</p><p>需转换为 shape：[height, width, channel] -> [32, 32, 3]</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=n>tf</span><span class=o>.</span><span class=n>transpose</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span>
<span class=c1># [0, 1, 2] --&gt; [1, 2, 0]，三维数组位置转换，</span>
<span class=c1># 原来1号位置放到0号，2号位置放到1号，0号放到3号</span>
</code></pre></td></tr></table></div></div><h4 id=批处理-2>批处理</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>os</span>
<span class=kn>import</span> <span class=nn>tensorflow</span> <span class=k>as</span> <span class=nn>tf</span>


<span class=k>class</span> <span class=nc>BinRead</span><span class=p>:</span>
    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=c1># 初始化</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>height</span> <span class=o>=</span> <span class=mi>32</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>width</span> <span class=o>=</span> <span class=mi>32</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>channels</span> <span class=o>=</span> <span class=mi>3</span>
        <span class=c1># 字节数</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>image_bytes</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>height</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>width</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>channels</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>label_bytes</span> <span class=o>=</span> <span class=mi>1</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>all_bytes</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>image_bytes</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>label_bytes</span>

    <span class=k>def</span> <span class=nf>bin_read</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>file_l</span><span class=p>):</span>
        <span class=c1># 1、构造文件名队列</span>
        <span class=n>file_queue</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>string_input_producer</span><span class=p>(</span><span class=n>file_l</span><span class=p>)</span>
        <span class=c1># 2、读取与解码</span>
        <span class=n>reader</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>FixedLengthRecordReader</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>all_bytes</span><span class=p>)</span>
        <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=o>=</span> <span class=n>reader</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>file_queue</span><span class=p>)</span>
        <span class=c1># 解码</span>
        <span class=n>value_decode</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>decode_raw</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>tf</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
        <span class=c1># 将目标值与特征值切片</span>
        <span class=n>label</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>slice</span><span class=p>(</span><span class=n>value_decode</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>label_bytes</span><span class=p>])</span>
        <span class=n>image</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>slice</span><span class=p>(</span><span class=n>value_decode</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>image_bytes</span><span class=p>])</span>

        <span class=c1># 调整图片形状，动态调整</span>
        <span class=n>image_reshape</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>shape</span><span class=o>=</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>channels</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>height</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>width</span><span class=p>])</span>
        <span class=c1># 图片转置</span>
        <span class=n>image_transpose</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>transpose</span><span class=p>(</span><span class=n>image_reshape</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span>
        <span class=c1># 调整图片类型</span>
        <span class=c1># image_cast = tf.cast(image_transpose, tf.float32)</span>
        <span class=c1># 3、批处理</span>
        <span class=c1># image_batch = tf.train.batch([image_cast], batch_size=100, num_threads=2, capacity=100)</span>
        <span class=n>image_batch</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>batch</span><span class=p>([</span><span class=n>image_transpose</span><span class=p>],</span> <span class=n>batch_size</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>num_threads</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>capacity</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span>
        <span class=nb>print</span><span class=p>(</span><span class=n>image_batch</span><span class=p>)</span>
        <span class=c1># Tensor(&#34;batch:0&#34;, shape=(100, 32, 32, 3), dtype=float32)</span>
        <span class=k>with</span> <span class=n>tf</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span> <span class=k>as</span> <span class=n>sess</span><span class=p>:</span>
            <span class=c1># 开启线程，创建线程协调员</span>
            <span class=n>coord</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>Coordinator</span><span class=p>()</span>
            <span class=n>threads</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>start_queue_runners</span><span class=p>(</span><span class=n>sess</span><span class=o>=</span><span class=n>sess</span><span class=p>,</span> <span class=n>coord</span><span class=o>=</span><span class=n>coord</span><span class=p>)</span>

            <span class=n>key_new</span><span class=p>,</span> <span class=n>value_new</span><span class=p>,</span> <span class=n>value_decode_new</span><span class=p>,</span> <span class=n>image_batch_new</span> <span class=o>=</span> <span class=n>sess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=n>value_decode</span><span class=p>,</span> <span class=n>image_batch</span><span class=p>])</span>
            <span class=nb>print</span><span class=p>(</span><span class=n>key_new</span><span class=p>)</span>
            <span class=nb>print</span><span class=p>(</span><span class=n>value_new</span><span class=p>)</span>
            <span class=nb>print</span><span class=p>(</span><span class=n>value_decode_new</span><span class=p>)</span>
            <span class=c1># [  1  35  27 ... 169 168 168]</span>
            <span class=nb>print</span><span class=p>(</span><span class=n>image_batch_new</span><span class=p>)</span>

            <span class=c1># 回收线程</span>
            <span class=n>coord</span><span class=o>.</span><span class=n>request_stop</span><span class=p>()</span>
            <span class=n>coord</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>threads</span><span class=o>=</span><span class=n>threads</span><span class=p>)</span>


<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
    <span class=c1># 构造路径+文件名列表</span>
    <span class=n>filename</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;.\cifar-10-batches-bin&#39;</span><span class=p>)</span>
    <span class=c1># print(filename)</span>
    <span class=n>file_list</span> <span class=o>=</span> <span class=p>[</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;.\cifar-10-batches-bin&#39;</span><span class=p>,</span> <span class=n>file</span><span class=p>)</span> <span class=k>for</span> <span class=n>file</span> <span class=ow>in</span> <span class=n>filename</span> <span class=k>if</span> <span class=n>file</span><span class=p>[</span><span class=o>-</span><span class=mi>3</span><span class=p>:]</span> <span class=o>==</span> <span class=s1>&#39;bin&#39;</span><span class=p>]</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>file_list</span><span class=p>)</span>
    <span class=n>BinRead</span><span class=p>()</span><span class=o>.</span><span class=n>bin_read</span><span class=p>(</span><span class=n>file_list</span><span class=p>)</span>

</code></pre></td></tr></table></div></div><h2 id=tfrecords-文件>TFRecords 文件</h2><p>它其实是一种二进制文件，能够更好的利用内存，更方便复制和移动，并且不需要单独的标签文件</p><p>使用步骤：</p><ol><li>获取数据</li><li>将数据填入到 Example 协议内存块（protocol buffer）</li><li>将协议内存块序列化为字符串，并且通过<code>tf.python_io.TFRecordWriter</code>写入到 TFRecords 文件</li></ol><p>文件格式：*.tfrecords</p><h3 id=结构分析>结构分析</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>features {
    feature {
        key: &#34;age&#34;
        value { float_list {
            value: 29.0
       }}
     }
    feature {
        key: &#34;movie&#34;
        value { bytes_list {
            value: &#34;The Shawshank Redemption&#34;
            value: &#34;Fight Club&#34;
       }}
     }
 }
</code></pre></td></tr></table></div></div><ul><li><code>tf.train.Example</code>协议内存块（协议内存块包含了字段<code>Features</code>）</li><li><code>Features</code>包含了一个<code>Feature</code>字段</li><li><code>Feature</code>包含了要写入的数据、并指明数据类型<ul><li>这是一个样本的结构，批数据需要循环存入这样的结构</li></ul></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=n>example</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>Example</span><span class=p>(</span><span class=n>features</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>Features</span><span class=p>(</span><span class=n>feature</span><span class=o>=</span><span class=p>{</span>
    <span class=s1>&#39;image&#39;</span><span class=p>:</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>Feature</span><span class=p>(</span><span class=n>bytes_list</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>BytesList</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=p>[</span><span class=n>image</span><span class=p>])),</span>
    <span class=s1>&#39;label&#39;</span><span class=p>:</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>Feature</span><span class=p>(</span><span class=n>int64_list</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>Int64List</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=p>[</span><span class=n>label</span><span class=p>])),</span>
<span class=p>}))</span>
<span class=n>example</span><span class=o>.</span><span class=n>SerializeToString</span><span class=p>()</span>
</code></pre></td></tr></table></div></div><ul><li><code>tf.train.Example(features=None)</code><ul><li>写入 tfrecords 文件</li><li>features：<code>tf.train.Features</code>类型的特征实例</li><li>return：example 格式协议块</li></ul></li><li><code>tf.train.Features(feature=None)</code><ul><li>构建每个样本的信息键值对</li><li>feature：<strong>字典数据</strong>，key 为要保存的名字</li><li>value：<code>tf.train.Feature</code>实例</li><li>return：Features 类型</li></ul></li><li><code>tf.train.Feature(options)</code><ul><li>options<ul><li><code>bytes_list=tf.train.BytesList(value=[Bytes])</code></li><li><code>int64_list=tf.train.Int64List(value=[Value])</code></li><li>等</li></ul></li><li>支持存入的类型如下<ul><li><code>tf.train.BytesList(value=[Bytes])</code></li><li><code>tf.train.Int64List(value=[Value])</code></li><li><code>tf.train.FloatList(value=[Value])</code></li></ul></li></ul></li></ul><blockquote><p>这种结构很好的实现了数据和标签（训练的类别标签）或者其他属性数据存储在同一文件中</p></blockquote><h3 id=案例cifar10-数据存入-tfrecords>案例：CIFAR10 数据存入 TFRecords</h3><h4 id=分析>分析</h4><ul><li>构造存储实例，<code>tf.python_io.TFRecordWriter(path)</code><ul><li>写入 tfrecord 文件</li><li>path：文件路径</li><li>return：写方法<ul><li><code>.write(record)</code>：写入一个 example</li><li><code>close()</code></li></ul></li></ul></li><li>循环将数据填入到<code>Example</code>协议内存块</li></ul><h4 id=代码>代码</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>write_to_tfr</span><span class=p>(</span><span class=n>image_batch</span><span class=p>,</span> <span class=n>label_batch</span><span class=p>):</span>
    <span class=s2>&#34;&#34;&#34;
</span><span class=s2>    将样本特征值目标值一起写入文件
</span><span class=s2>    :param image_batch:
</span><span class=s2>    :param label_batch:
</span><span class=s2>    :return:
</span><span class=s2>    &#34;&#34;&#34;</span>
    <span class=k>with</span> <span class=n>tf</span><span class=o>.</span><span class=n>python_io</span><span class=o>.</span><span class=n>TFRecordWriter</span><span class=p>(</span><span class=s1>&#39;cifar.tfrecords&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>writer</span><span class=p>:</span>
        <span class=c1># 循环构造example对象，并序列化写入</span>
        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100</span><span class=p>):</span>
            <span class=n>image</span> <span class=o>=</span> <span class=n>image_batch</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>tostring</span><span class=p>()</span>
            <span class=n>label</span> <span class=o>=</span> <span class=n>label_batch</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
            <span class=n>example</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>Example</span><span class=p>(</span><span class=n>features</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>Features</span><span class=p>(</span><span class=n>feature</span><span class=o>=</span><span class=p>{</span>
                <span class=s1>&#39;image&#39;</span><span class=p>:</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>Feature</span><span class=p>(</span><span class=n>bytes_list</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>BytesList</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=p>[</span><span class=n>image</span><span class=p>])),</span>
                <span class=s1>&#39;label&#39;</span><span class=p>:</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>Feature</span><span class=p>(</span><span class=n>int64_list</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>Int64List</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=p>[</span><span class=n>label</span><span class=p>])),</span>
            <span class=p>}))</span>

            <span class=n>writer</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>example</span><span class=o>.</span><span class=n>SerializeToString</span><span class=p>())</span>
</code></pre></td></tr></table></div></div><h3 id=案例读取-tfrecords>案例：读取 TFRecords</h3><p>需要有一个解析 Example 过程，可以使用<code>tf.TFRecordReader</code>的<code>tf.parse_single_example</code>解析器，可以将<code>Example</code>协议内存块解析为张量</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=n>feature</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>parse_single_example</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>features</span><span class=o>=</span><span class=p>{</span>
    <span class=s1>&#39;image&#39;</span><span class=p>:</span> <span class=n>tf</span><span class=o>.</span><span class=n>FixedLenFeature</span><span class=p>([],</span> <span class=n>tf</span><span class=o>.</span><span class=n>string</span><span class=p>),</span>
    <span class=s1>&#39;label&#39;</span><span class=p>:</span> <span class=n>tf</span><span class=o>.</span><span class=n>FixedLenFeature</span><span class=p>([],</span> <span class=n>tf</span><span class=o>.</span><span class=n>int64</span><span class=p>),</span>
<span class=p>})</span>
<span class=n>image</span> <span class=o>=</span> <span class=n>feature</span><span class=p>[</span><span class=s1>&#39;image&#39;</span><span class=p>]</span>
<span class=n>label</span> <span class=o>=</span> <span class=n>feature</span><span class=p>[</span><span class=s1>&#39;label&#39;</span><span class=p>]</span>
</code></pre></td></tr></table></div></div><ul><li><code>tf.parse_single_example(serialized, features=None, name=None)</code><ul><li>解析一个单一的 Example 原型</li><li>serialized：标量字符串 Tensor，一个序列化的 Example</li><li>features：dict&rsquo;字典数据，键为读取的名字，值为 FixedLenFeature</li><li>return：一个 键值对组成的字典，键为读取的名字</li></ul></li><li><code>tf.FixedLenFeature(shape,dtype)</code><ul><li>shape：输入数据的形状，一般不指定，为空列表</li><li>dtype：输入数据类型，与存储进文件的类型要一致</li><li>类型只能是 float32，int64，string</li></ul></li></ul><h4 id=步骤>步骤</h4><ol><li>构造文件名队列</li><li>读取与解码<ol><li>读取</li><li>解析 example</li><li>解码<code>tf.decode_raw()</code></li></ol></li><li>构造批处理队列</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python>    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>read_tfrecords</span><span class=p>():</span>
        <span class=c1># 1、构造文件名队列</span>
        <span class=n>file_queue</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>string_input_producer</span><span class=p>([</span><span class=s1>&#39;cifar.tfrecords&#39;</span><span class=p>])</span>
        <span class=c1># 2、读取与解码</span>
        <span class=c1># 读取</span>
        <span class=n>reader</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>TFRecordReader</span><span class=p>()</span>
        <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=o>=</span> <span class=n>reader</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>file_queue</span><span class=p>)</span>
        <span class=c1># 解析example</span>
        <span class=n>feature</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>parse_single_example</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>features</span><span class=o>=</span><span class=p>{</span>
            <span class=s1>&#39;image&#39;</span><span class=p>:</span> <span class=n>tf</span><span class=o>.</span><span class=n>FixedLenFeature</span><span class=p>([],</span> <span class=n>tf</span><span class=o>.</span><span class=n>string</span><span class=p>),</span>
            <span class=s1>&#39;label&#39;</span><span class=p>:</span> <span class=n>tf</span><span class=o>.</span><span class=n>FixedLenFeature</span><span class=p>([],</span> <span class=n>tf</span><span class=o>.</span><span class=n>int64</span><span class=p>),</span>
        <span class=p>})</span>
        <span class=n>image</span> <span class=o>=</span> <span class=n>feature</span><span class=p>[</span><span class=s1>&#39;image&#39;</span><span class=p>]</span>
        <span class=n>label</span> <span class=o>=</span> <span class=n>feature</span><span class=p>[</span><span class=s1>&#39;label&#39;</span><span class=p>]</span>
        <span class=c1># 解码</span>
        <span class=n>image_decoded</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>decode_raw</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>tf</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
        <span class=c1># 形状调整</span>
        <span class=n>image_reshaped</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>image_decoded</span><span class=p>,</span> <span class=p>[</span><span class=mi>32</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
        <span class=c1># 3、构造批处理队列</span>

        <span class=c1># 开启会话</span>
        <span class=k>with</span> <span class=n>tf</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span> <span class=k>as</span> <span class=n>sess</span><span class=p>:</span>
            <span class=c1># 开启线程</span>
            <span class=c1># 创建线程协调员</span>
            <span class=n>coord</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>Coordinator</span><span class=p>()</span>
            <span class=n>threads</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>start_queue_runners</span><span class=p>(</span><span class=n>sess</span><span class=o>=</span><span class=n>sess</span><span class=p>,</span> <span class=n>coord</span><span class=o>=</span><span class=n>coord</span><span class=p>)</span>

            <span class=n>image_new</span><span class=p>,</span> <span class=n>label_new</span> <span class=o>=</span> <span class=n>sess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span><span class=n>image_reshaped</span><span class=p>,</span> <span class=n>label</span><span class=p>])</span>
            <span class=nb>print</span><span class=p>(</span><span class=n>image_new</span><span class=p>)</span>
            <span class=nb>print</span><span class=p>(</span><span class=n>label_new</span><span class=p>)</span>
            <span class=c1># 回收线程</span>
            <span class=n>coord</span><span class=o>.</span><span class=n>request_stop</span><span class=p>()</span>
            <span class=n>coord</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>threads</span><span class=o>=</span><span class=n>threads</span><span class=p>)</span>

</code></pre></td></tr></table></div></div><h2 id=神经网络基础>神经网络基础</h2><h3 id=神经网络>神经网络</h3><p>由三层构成：输入层，隐藏层，输出层</p><p><img src=https://raw.githubusercontent.com/Pandalzy/cloud_img/master/img/blog20200312214125.jpg alt></p><blockquote><p>​ 其中每层圆圈代表一个神经元，隐藏层和输出层的神经元把输入的数据计算后输出，输出层的神经元只是输出</p></blockquote><ul><li>神经网络特点<ul><li>每个连接都有权值</li><li>同一层神经元之间没有连接</li><li>最后的输出结果对应的层也称之为<strong>全连接层</strong></li></ul></li></ul><h4 id=感知机>感知机</h4><p>感知机就是模拟大脑神经网络处理数据的过程</p><p><img src=https://raw.githubusercontent.com/Pandalzy/cloud_img/master/img/blog20200313180033.png alt></p><blockquote><p>感知机是一种基础分类模型，类似于逻辑回归，不同的是，感知机的激活函数用的书<code>sign</code>，而逻辑回归用的是<code>sigmoid</code>，<strong>感知机也具有连接的权重和偏置</strong></p><p>$$
u=\sum_i^n{w_ix_i}+b
$$</p><p>$$
y=sign(u)=\left{
\begin{aligned}
+1,& &u>0 \<br>-1,& &u\leq0
\end{aligned}\right.
$$</p></blockquote><p>可解决问题：或、与、异或</p><h3 id=神经网络基础-1>神经网络基础</h3><ul><li>损失函数<ul><li>交叉熵损失</li><li>总损失、平均损失</li><li>最小二乘法——线性回归损失——均方误差</li></ul></li><li>优化损失函数</li></ul><p>神经网络主要用于分类，任意事件发生的概率在 0-1 之间，且总有某一个事件发生（概率和为 1）。如果将分类问题中“一个样例属于某个类别”，看成一个概率事件，那么训练数据的正确答案就符合一个概率分布。Softmax 回归就是一个常用的将神经网络前向传播得到的结果也变成概率分布的方法。</p><h4 id=softmax-回归>Softmax 回归</h4><p>logits 加上 softmax 映射——多分类</p><p>将神经网络输出转换成概率结果</p><p>$$
softmax(y)<em>i=\frac{e^{y_i}}{\sum</em>{j=1}^n{e^{y_j}}}
$$</p><p><img src=https://raw.githubusercontent.com/Pandalzy/cloud_img/master/img/blog20200313184347.png alt></p><p><img src=https://raw.githubusercontent.com/Pandalzy/cloud_img/master/img/blog20200314180553.png alt></p><h4 id=交叉熵损失公式>交叉熵损失公式</h4><p>$$
H_{y^\prime}=-\sum_i^ny_{i^\prime}log(y_i)
$$</p><p>为了能够衡量距离，目标值需要进行 one-hot 编码，能与概率值一一对应，如下图</p><p><img src=https://raw.githubusercontent.com/Pandalzy/cloud_img/master/img/blog20200313190058.png alt></p><h4 id=softmax交叉熵损失-api>softmax、交叉熵损失 API</h4><ul><li><code>tf.nn.softmax_cross_entropy_with_logits(labels=None, logits=None, name=None)</code><ul><li>计算 logits 和 labels 之间的交叉损失熵</li><li>labels：标签值（真实值）</li><li>logits：样本加权之后的值</li><li>return：损失值列表</li></ul></li><li><code>tf.reduce_mean(input_tensor)</code><ul><li>计算张量的尺寸的元素平均值</li></ul></li></ul><h3 id=案例mnist-手写数字识别>案例：Mnist 手写数字识别</h3><h4 id=数据集>数据集</h4><p><img src=https://raw.githubusercontent.com/Pandalzy/cloud_img/master/img/blog20200313193736.png alt></p><ul><li>特征值<ul><li>28*28=784</li></ul></li><li>目标值<ul><li>分类：one-hot 编码</li><li>可能值：0, 1, 2, &mldr;,9</li><li>编码：0, 1, 0, &mldr;,0（值为 1）</li></ul></li></ul><h4 id=数据获取-api>数据获取 API</h4><ul><li><code>from tensorflow.examples.tutorials.mnist import input_data</code><ul><li><code>mnist = input_data.read_data_sets(path, one_hot=True)</code><ul><li><code>mnist.train.next_batch(100)</code>提供批量获取功能</li><li><code>mnist.train.images</code></li><li><code>mnist.train.labels</code></li><li><code>mnist.test.images</code></li><li><code>mnist.test.labels</code></li></ul></li></ul></li></ul><h4 id=分析-代码>分析-代码</h4><ul><li>完善功能<ul><li>增加准确率</li><li>增加变量 tensorboard 显示</li><li>增加模型保存加载</li><li>增加模型预测结果输出</li></ul></li></ul><p>采用只有一层，即最后一个输出层的神经网络，也称为全连接层神经网络</p><p><img src=https://raw.githubusercontent.com/Pandalzy/cloud_img/master/img/blog20200313193212.png alt></p><h5 id=全连接>全连接</h5><ul><li><code>y = w1x1 + w2x2 + ... + b</code></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=n>x</span><span class=p>[</span><span class=kc>None</span><span class=p>,</span> <span class=mi>784</span><span class=p>]</span> <span class=o>*</span> <span class=n>w</span><span class=p>[</span><span class=mi>784</span><span class=p>,</span> <span class=mi>10</span><span class=p>]</span> <span class=o>+</span> <span class=n>bias</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span> <span class=o>=</span> <span class=n>y_predict</span><span class=p>[</span><span class=kc>None</span><span class=p>,</span> <span class=mi>10</span><span class=p>]</span>
<span class=n>r</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>softmax_cross_entropy_with_logits</span><span class=p>(</span><span class=n>labels</span><span class=o>=</span><span class=n>y_true</span><span class=p>,</span> <span class=n>logits</span><span class=o>=</span><span class=n>y_predict</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
<span class=n>error</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>reduce_mean</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>

</code></pre></td></tr></table></div></div><h5 id=准确率>准确率</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=n>equal_list</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>equal</span><span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span> <span class=n>tf</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>y_predict</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>))</span>
<span class=n>accuracy</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>reduce_mean</span><span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>cast</span><span class=p>(</span><span class=n>equal_list</span><span class=p>,</span> <span class=n>tf</span><span class=o>.</span><span class=n>float32</span><span class=p>))</span>

</code></pre></td></tr></table></div></div><h5 id=代码-1>代码</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>tensorflow</span> <span class=k>as</span> <span class=nn>tf</span>
<span class=kn>from</span> <span class=nn>tensorflow.examples.tutorials.mnist</span> <span class=kn>import</span> <span class=n>input_data</span>

<span class=k>def</span> <span class=nf>full_connection</span><span class=p>():</span>
    <span class=s2>&#34;&#34;&#34;
</span><span class=s2>    用全连接对手写数字进行识别
</span><span class=s2>    :return:
</span><span class=s2>    &#34;&#34;&#34;</span>
    <span class=c1># 1、准备数据</span>
    <span class=n>mnist</span> <span class=o>=</span> <span class=n>input_data</span><span class=o>.</span><span class=n>read_data_sets</span><span class=p>(</span><span class=s2>&#34;./mnist_data&#34;</span><span class=p>,</span> <span class=n>one_hot</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=c1># 用占位符定义真实数据</span>
    <span class=n>x</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>placeholder</span><span class=p>(</span><span class=n>dtype</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>float32</span><span class=p>,</span> <span class=n>shape</span><span class=o>=</span><span class=p>[</span><span class=kc>None</span><span class=p>,</span> <span class=mi>784</span><span class=p>])</span>
    <span class=n>y_true</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>placeholder</span><span class=p>(</span><span class=n>dtype</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>float32</span><span class=p>,</span> <span class=n>shape</span><span class=o>=</span><span class=p>[</span><span class=kc>None</span><span class=p>,</span> <span class=mi>10</span><span class=p>])</span>

    <span class=c1># 2、构造模型 - 全连接</span>
    <span class=c1># [None, 784] * W[784, 10] + Bias = [None, 10]</span>
    <span class=n>weights</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>Variable</span><span class=p>(</span><span class=n>initial_value</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>random_normal</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=p>[</span><span class=mi>784</span><span class=p>,</span> <span class=mi>10</span><span class=p>],</span> <span class=n>stddev</span><span class=o>=</span><span class=mf>0.01</span><span class=p>))</span>
    <span class=n>bias</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>Variable</span><span class=p>(</span><span class=n>initial_value</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>random_normal</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=p>[</span><span class=mi>10</span><span class=p>],</span> <span class=n>stddev</span><span class=o>=</span><span class=mf>0.1</span><span class=p>))</span>
    <span class=n>y_predict</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>matmul</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>weights</span><span class=p>)</span> <span class=o>+</span> <span class=n>bias</span>


    <span class=c1># 3、构造损失函数</span>
    <span class=n>loss_list</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>softmax_cross_entropy_with_logits</span><span class=p>(</span><span class=n>logits</span><span class=o>=</span><span class=n>y_predict</span><span class=p>,</span> <span class=n>labels</span><span class=o>=</span><span class=n>y_true</span><span class=p>)</span>
    <span class=n>loss</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>reduce_mean</span><span class=p>(</span><span class=n>loss_list</span><span class=p>)</span>
    <span class=c1># 4、优化损失</span>
    <span class=n>optimizer</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>GradientDescentOptimizer</span><span class=p>(</span><span class=n>learning_rate</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span><span class=o>.</span><span class=n>minimize</span><span class=p>(</span><span class=n>loss</span><span class=p>)</span>
    <span class=c1># optimizer = tf.train.AdamOptimizer(learning_rate=0.1).minimize(loss)</span>

    <span class=c1># 5、增加准确率计算</span>
    <span class=n>equal_list</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>equal</span><span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span> <span class=n>tf</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>y_predict</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>))</span>
    <span class=n>accuracy</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>reduce_mean</span><span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>cast</span><span class=p>(</span><span class=n>equal_list</span><span class=p>,</span> <span class=n>tf</span><span class=o>.</span><span class=n>float32</span><span class=p>))</span>

    <span class=c1># 初始化变量</span>
    <span class=n>init</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>global_variables_initializer</span><span class=p>()</span>

    <span class=k>with</span> <span class=n>tf</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span> <span class=k>as</span> <span class=n>sess</span><span class=p>:</span>
        <span class=n>sess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>init</span><span class=p>)</span>
        <span class=c1># 开始训练</span>
        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>50000</span><span class=p>):</span>
            <span class=c1># 获取真实值</span>
            <span class=n>image</span><span class=p>,</span> <span class=n>label</span> <span class=o>=</span> <span class=n>mnist</span><span class=o>.</span><span class=n>train</span><span class=o>.</span><span class=n>next_batch</span><span class=p>(</span><span class=mi>500</span><span class=p>)</span>

            <span class=n>_</span><span class=p>,</span> <span class=n>loss_value</span><span class=p>,</span> <span class=n>accuracy_value</span> <span class=o>=</span> <span class=n>sess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span><span class=n>optimizer</span><span class=p>,</span> <span class=n>loss</span><span class=p>,</span> <span class=n>accuracy</span><span class=p>],</span> <span class=n>feed_dict</span><span class=o>=</span><span class=p>{</span><span class=n>x</span><span class=p>:</span> <span class=n>image</span><span class=p>,</span> <span class=n>y_true</span><span class=p>:</span> <span class=n>label</span><span class=p>})</span>

            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;第</span><span class=si>%d</span><span class=s2>次的损失为</span><span class=si>%f</span><span class=s2>，准确率为</span><span class=si>%f</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>loss_value</span><span class=p>,</span> <span class=n>accuracy_value</span><span class=p>))</span>




<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
    <span class=n>full_connection</span><span class=p>()</span>

</code></pre></td></tr></table></div></div></div><div class=post-copyright><p class=copyright-item><span class=item-title>Author</span>
<span class=item-content>zyuanlee</span></p><p class=copyright-item><span class=item-title>LastMod</span>
<span class=item-content>2020-03-14</span></p></div><footer class=post-footer><div class=post-tags><a href=/tags/tensorflow/>TensorFlow</a>
<a href=/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/>深度学习</a></div><nav class=post-nav><a class=prev href=/post/2020-03-19_tensorflow%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/><i class="iconfont icon-left"></i>
<span class="prev-text nav-default">TensorFlow卷积神经网络</span>
<span class="prev-text nav-mobile">Prev</span></a>
<a class=next href=/post/2020-03-09_tensorflow%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/><span class="next-text nav-default">TensorFlow框架介绍</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:your@email.com class="iconfont icon-email" title=email></a><a href=http://localhost:1313 class="iconfont icon-stack-overflow" title=stack-overflow></a><a href=http://localhost:1313 class="iconfont icon-twitter" title=twitter></a><a href=http://localhost:1313 class="iconfont icon-facebook" title=facebook></a><a href=http://localhost:1313 class="iconfont icon-linkedin" title=linkedin></a><a href=http://localhost:1313 class="iconfont icon-google" title=google></a><a href=http://localhost:1313 class="iconfont icon-github" title=github></a><a href=http://localhost:1313 class="iconfont icon-weibo" title=weibo></a><a href=http://localhost:1313 class="iconfont icon-zhihu" title=zhihu></a><a href=http://localhost:1313 class="iconfont icon-douban" title=douban></a><a href=http://localhost:1313 class="iconfont icon-pocket" title=pocket></a><a href=http://localhost:1313 class="iconfont icon-tumblr" title=tumblr></a><a href=http://localhost:1313 class="iconfont icon-instagram" title=instagram></a><a href=http://localhost:1313 class="iconfont icon-gitlab" title=gitlab></a><a href=http://localhost:1313 class="iconfont icon-bilibili" title=bilibili></a><a href=http://localhost:1313/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2019 -
2021<span class=heart><i class="iconfont icon-heart"></i></span><span>zyuanlee</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js></script></body></html>